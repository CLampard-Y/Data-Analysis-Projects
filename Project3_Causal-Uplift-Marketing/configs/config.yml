# ================================================
# PCU global configuration
# Scope: data pipeline + causal/uplift baseline settings
# ================================================

# File paths for input/output artifacts
paths:
  raw_data: "data/raw/hillstrom.csv"
  raw_text_data: "data/raw/hillstrom_raw_text.csv"
  cleaned_data: "data/processed/hillstrom_cleaned.csv"
  features_data: "data/processed/hillstrom_features.csv"
  figures_dir: "outputs/figures/"
  matched_data: "data/processed/hillstrom_matched.csv"
  cate_vectors: "data/processed/cate_vectors.npz"
  qini_results: "data/processed/qini_results.json"

# Core business columns and modeling covariates
data:
  # 0/1 treatment indicator
  treatment_col: "treatment"
  # core business index 
  outcome_col: "conversion"
  # minor business index ()
  spend_col: "spend"
  #Covariates (features for PSM and Uplift)
  # Why not include zip_Rural,channel_Multichannel (What will happen if we include them):
  #   Any one can be represented linearly by the other two
  #     (e.g. zip_Rural = zip_Urban + zip_Suburban)
  #   In linear/logistic regression, this can lead to:
  #     - The design matrix X being rank deficient
  #     - The matrix X^T X being non-invertible
  #     - The inability to solve for regression coefficients (or coefficients not being unique)
  covariates:
    - recency
    - history
    - mens
    - womens
    - newbie
    - channel_Phone
    - channel_Web
    - zip_Surburban
    - zip_Urban

# Propensity Score Matching defaults
psm:
  # caliper = factor Ã— std(propensity_score)
  caliper_factor: 0.2
  # 1:1 without replacement
  matching_ratio: 1

# Uplift model baseline hyperparameters
uplift:
  base_model: "xgboost"
  n_estimators: 100
  max_depth: 5

  # ==========================
  # Optinal (Not used in uplift section)
  # ==========================
  # Required in production-style training to prevent overfitting
  #early_stopping_rounds: 10

  # Hold-out ratio for validation-based early stopping
  #val_ratio: 0.2

  # Validation split strategy to keep treatment/control representation stable
  #split_strategy: "stratified_shuffle"

  # Primary stratification key for uplift validity
  #stratify_by: "treatment"

  # Optional guard: if any cohort falls below this count in validation, trigger resplit/fallback
  #min_group_size_in_val: 100
  
  # Model selection target should align with uplift business objective
  #eval_metric_for_selection: "auuc"

  # =================================================================================
  # ----- Phase 2 optional safeguards (disabled) -----
  # All these parameters are embedded in function to avoide:
  #   1. Over-fitting 
  #   2. Over-complicating 
  # =================================================================================
  # imbalance_handling: true           # automatically rebalance minority classes
  # pos_weight_strategy: "auto"        # options: auto | manual

  # Control Type I error rate
  # min_leaf_treated: 100               # minimum treated samples per segment/bin
  # min_leaf_control: 100               # minimum control samples per segment/bin
  
  # collinearity_guard: true
  # correlation_threshold: 0.95         # drop one of highly correlated feature pairs

# Reproducibility control
general:
  random_state: 42
